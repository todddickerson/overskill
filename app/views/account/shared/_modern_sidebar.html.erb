<div class="w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col hidden lg:flex" data-controller="sidebar">
  <!-- Team Selector -->
  <div class="p-4 border-b border-gray-200 dark:border-gray-700">
    <div class="relative" data-controller="dropdown">
      <button class="w-full flex items-center justify-between p-3 rounded-lg bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"
              data-action="click->dropdown#toggle">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-yellow-400 to-yellow-600 flex items-center justify-center text-white font-bold">
            <%= current_team.name[0].upcase %>
          </div>
          <div class="text-left">
            <p class="text-sm font-semibold text-gray-900 dark:text-white"><%= current_team.name %></p>
            <p class="text-xs text-gray-500 dark:text-gray-400">Team workspace</p>
          </div>
        </div>
        <i class="fas fa-chevron-down text-gray-500"></i>
      </button>
      
      <div class="hidden absolute top-full left-0 right-0 mt-2 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 max-h-64 overflow-y-auto" data-dropdown-target="menu">
        <% current_user.teams.each do |team| %>
          <%= link_to account_team_path(team), 
                      class: "flex items-center space-x-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-700 #{team == current_team ? 'bg-yellow-50 dark:bg-yellow-900/20' : ''}", 
                      data: { turbo_frame: "_top" } do %>
            <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-gray-400 to-gray-600 flex items-center justify-center text-white font-semibold text-sm">
              <%= team.name[0].upcase %>
            </div>
            <div class="flex-1">
              <p class="text-sm font-medium text-gray-900 dark:text-white"><%= team.name %></p>
              <p class="text-xs text-gray-500 dark:text-gray-400"><%= team.apps.count %> apps</p>
            </div>
            <% if team == current_team %>
              <i class="fas fa-check text-yellow-500"></i>
            <% end %>
          <% end %>
        <% end %>
        
        <div class="border-t border-gray-200 dark:border-gray-700 p-2">
          <%= link_to new_account_team_path, class: "flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300" do %>
            <i class="fas fa-plus-circle"></i>
            <span class="text-sm">Create new team</span>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <!-- Navigation Menu -->
  <nav class="flex-1 overflow-y-auto p-4 space-y-1">
    <!-- Main Navigation -->
    <div class="space-y-1">
      <%= link_to account_team_path(current_team), 
                  class: "nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg #{current_page?(account_team_path(current_team)) ? 'bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-400' : 'text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700'}" do %>
        <i class="fas fa-home mr-3 text-base <%= current_page?(account_team_path(current_team)) ? 'text-yellow-600' : 'text-gray-400' %>"></i>
        Dashboard
      <% end %>

      <%= link_to account_team_apps_path(current_team), 
                  class: "nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg #{controller_name == 'apps' ? 'bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-400' : 'text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700'}" do %>
        <i class="fas fa-cube mr-3 text-base <%= controller_name == 'apps' ? 'text-yellow-600' : 'text-gray-400' %>"></i>
        Apps
        <span class="ml-auto bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 text-xs px-2 py-0.5 rounded-full">
          <%= current_team.apps.count %>
        </span>
      <% end %>

      <%= link_to generator_index_path, 
                  class: "nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg #{controller_name == 'generator' ? 'bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-400' : 'text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700'}" do %>
        <i class="fas fa-magic mr-3 text-base <%= controller_name == 'generator' ? 'text-yellow-600' : 'text-gray-400' %>"></i>
        AI Generator
        <span class="ml-auto">
          <span class="bg-gradient-to-r from-yellow-400 to-yellow-600 text-white text-xs px-2 py-0.5 rounded-full">New</span>
        </span>
      <% end %>
    </div>

    <!-- Apps Section -->
    <div class="pt-6">
      <h3 class="px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
        Recent Apps
      </h3>
      <div class="mt-2 space-y-1">
        <% current_team.apps.published.limit(5).each do |app| %>
          <%= link_to account_app_editor_path(app), 
                      class: "group flex items-center px-3 py-2 text-sm rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white" do %>
            <div class="w-6 h-6 rounded bg-gradient-to-br <%= ['from-blue-400 to-blue-600', 'from-green-400 to-green-600', 'from-purple-400 to-purple-600', 'from-pink-400 to-pink-600'].sample %> flex items-center justify-center text-white text-xs font-bold mr-3">
              <%= app.name[0].upcase %>
            </div>
            <span class="truncate"><%= app.name %></span>
            <i class="fas fa-external-link-alt ml-auto opacity-0 group-hover:opacity-100 text-xs"></i>
          <% end %>
        <% end %>
        
        <% if current_team.apps.count > 5 %>
          <%= link_to account_team_apps_path(current_team), 
                      class: "flex items-center px-3 py-2 text-sm rounded-lg text-yellow-600 dark:text-yellow-400 hover:bg-yellow-50 dark:hover:bg-yellow-900/20" do %>
            View all apps →
          <% end %>
        <% end %>
      </div>
    </div>

    <!-- Team Management -->
    <div class="pt-6">
      <h3 class="px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
        Team
      </h3>
      <div class="mt-2 space-y-1">
        <%= link_to account_team_memberships_path(current_team), 
                    class: "nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700" do %>
          <i class="fas fa-users mr-3 text-base text-gray-400"></i>
          Members
          <span class="ml-auto text-xs text-gray-500"><%= current_team.memberships.count %></span>
        <% end %>

        <% if can? :edit, current_team %>
          <%= link_to edit_account_team_path(current_team), 
                      class: "nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700" do %>
            <i class="fas fa-cog mr-3 text-base text-gray-400"></i>
            Settings
          <% end %>
        <% end %>

        <% if billing_enabled? %>
          <%= link_to account_team_billing_subscriptions_path(current_team), 
                      class: "nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700" do %>
            <i class="fas fa-credit-card mr-3 text-base text-gray-400"></i>
            Billing
          <% end %>
        <% end %>
      </div>
    </div>

    <!-- Developer Tools -->
    <% unless disable_developer_menu? %>
      <div class="pt-6">
        <h3 class="px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
          Developer
        </h3>
        <div class="mt-2 space-y-1">
          <%= link_to account_team_platform_applications_path(current_team), 
                      class: "nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700" do %>
            <i class="fas fa-key mr-3 text-base text-gray-400"></i>
            API Keys
          <% end %>

          <% if webhooks_enabled? %>
            <%= link_to account_team_webhooks_outgoing_endpoints_path(current_team), 
                        class: "nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700" do %>
              <i class="fas fa-plug mr-3 text-base text-gray-400"></i>
              Webhooks
            <% end %>
          <% end %>

          <%= link_to account_team_database_config_path(current_team), 
                      class: "nav-item group flex items-center px-3 py-2 text-sm font-medium rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700" do %>
            <i class="fas fa-database mr-3 text-base text-gray-400"></i>
            Database
          <% end %>
        </div>
      </div>
    <% end %>
  </nav>

  <!-- Footer -->
  <div class="p-4 border-t border-gray-200 dark:border-gray-700">
    <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-400">
      <span>© 2025 Overskill</span>
      <%= link_to "Help", "#", class: "hover:text-gray-700 dark:hover:text-gray-300" %>
    </div>
  </div>
</div>

<!-- Mobile Sidebar Overlay -->
<div class="lg:hidden fixed inset-0 z-40 hidden" data-sidebar-target="overlay" data-action="click->sidebar#close">
  <div class="fixed inset-0 bg-gray-600 bg-opacity-75"></div>
  <div class="fixed inset-y-0 left-0 flex flex-col w-64 bg-white dark:bg-gray-800">
    <!-- Mobile sidebar content (duplicate of above) -->
    <!-- This would be the same content as above but for mobile -->
  </div>
</div>