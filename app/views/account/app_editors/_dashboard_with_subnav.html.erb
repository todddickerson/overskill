<div class="h-full flex bg-gray-50 dark:bg-gray-900 min-w-0" data-controller="dashboard-subnav" data-dashboard-subnav-current-view-value="overview">
  <!-- Dashboard Subnav -->
  <div class="w-12 lg:w-48 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex-shrink-0 transition-all duration-300">
    <nav class="p-1 lg:p-3 space-y-1">
      <!-- Overview -->
      <button class="w-full text-left px-2 lg:px-3 py-2 text-sm font-medium text-gray-900 dark:text-white bg-gray-100 dark:bg-gray-700 rounded-md flex items-center justify-center lg:justify-start"
              data-dashboard-nav="overview"
              data-action="click->dashboard-subnav#switchView"
              title="Overview">
        <i class="fas fa-th-large text-xs"></i>
        <span class="ml-2 hidden lg:inline">Overview</span>
      </button>
      
      <!-- Code Files -->
      <button class="w-full text-left px-2 lg:px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md flex items-center justify-center lg:justify-start"
              data-dashboard-nav="files"
              data-action="click->dashboard-subnav#switchView"
              title="Code Files">
        <i class="fas fa-code text-xs"></i>
        <span class="ml-2 hidden lg:inline">Code <span class="text-xs text-gray-500">(<%= files.count %>)</span></span>
      </button>
      
      <!-- Tables -->
      <button class="w-full text-left px-2 lg:px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md flex items-center justify-center lg:justify-start"
              data-dashboard-nav="tables"
              data-action="click->dashboard-subnav#switchView"
              title="Tables">
        <i class="fas fa-table text-xs"></i>
        <span class="ml-2 hidden lg:inline">Tables</span>
      </button>
      
      <!-- Schema -->
      <button class="w-full text-left px-2 lg:px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md flex items-center justify-center lg:justify-start"
              data-dashboard-nav="schema"
              data-action="click->dashboard-subnav#switchView"
              title="Schema">
        <i class="fas fa-project-diagram text-xs"></i>
        <span class="ml-2 hidden lg:inline">Schema</span>
      </button>
      
      <!-- Users -->
      <button class="w-full text-left px-2 lg:px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md flex items-center justify-center lg:justify-start"
              data-dashboard-nav="users"
              data-action="click->dashboard-subnav#switchView"
              title="Users">
        <i class="fas fa-users text-xs"></i>
        <span class="ml-2 hidden lg:inline">Users</span>
      </button>
      
      <!-- Analytics -->
      <button class="w-full text-left px-2 lg:px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md flex items-center justify-center lg:justify-start"
              data-dashboard-nav="analytics"
              data-action="click->dashboard-subnav#switchView"
              title="Analytics">
        <i class="fas fa-chart-line text-xs"></i>
        <span class="ml-2 hidden lg:inline">Analytics</span>
      </button>
      
      <!-- API -->
      <button class="w-full text-left px-2 lg:px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md flex items-center justify-center lg:justify-start"
              data-dashboard-nav="api"
              data-action="click->dashboard-subnav#switchView"
              title="API">
        <i class="fas fa-plug text-xs"></i>
        <span class="ml-2 hidden lg:inline">API</span>
      </button>
      
      <!-- Settings -->
      <button class="w-full text-left px-2 lg:px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md flex items-center justify-center lg:justify-start"
              data-dashboard-nav="settings"
              data-action="click->dashboard-subnav#switchView"
              title="Settings">
        <i class="fas fa-cog text-xs"></i>
        <span class="ml-2 hidden lg:inline">Settings</span>
      </button>
    </nav>
  </div>
  
  <!-- Dashboard Content Area -->
  <div class="flex-1 overflow-hidden">
    <!-- Overview Panel -->
    <div class="h-full overflow-y-auto p-4 sm:p-6 custom-scrollbar" data-dashboard-view="overview">
      <%= render "dashboard_overview", app: app %>
    </div>
    
    <!-- Code/Files Panel -->
    <div class="h-full hidden" data-dashboard-view="files">
      <% if files.any? %>
        <div class="h-full flex">
          <!-- File Tree -->
          <div class="flex-shrink-0 flex-grow-0">
            <%= render "file_tree", files: files, selected_file: selected_file, app: app %>
          </div>
          
          <!-- Code Display -->
          <%= turbo_frame_tag "code_editor", class: "w-full flex-1 min-w-0 bg-white dark:bg-gray-900 overflow-hidden" do %>
            <% if selected_file %>
              <%= render "code_editor", file: selected_file, app: app %>
            <% else %>
              <div class="h-full flex items-center justify-center text-gray-600 dark:text-gray-500">
                <div class="text-center">
                  <i class="fas fa-code text-4xl mb-4"></i>
                  <p>Select a file to view its contents</p>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
      <% else %>
        <div class="h-full flex items-center justify-center text-gray-600 dark:text-gray-500">
          <div class="text-center">
            <i class="fas fa-folder-open text-6xl mb-4"></i>
            <p class="text-xl">No files found for this app</p>
            <p class="text-sm mt-2">Generate files using the AI Assistant</p>
          </div>
        </div>
      <% end %>
    </div>
    
    <!-- Tables Panel -->
    <div class="h-full hidden overflow-y-auto p-4 sm:p-6 custom-scrollbar" data-dashboard-view="tables"
         data-controller="database-manager"
         data-database-manager-app-id-value="<%= app.id %>">
      <%= render "database_tables", app: app %>
    </div>
    
    <!-- Schema Panel -->
    <div class="h-full hidden" data-dashboard-view="schema">
      <%= render "schema_editor", app: app %>
    </div>
    
    <!-- Users Panel -->
    <div class="h-full hidden overflow-y-auto p-4 sm:p-6 custom-scrollbar" data-dashboard-view="users">
      <%= render "user_management", app: app %>
    </div>
    
    <!-- Analytics Panel -->
    <div class="h-full hidden overflow-y-auto p-4 sm:p-6 custom-scrollbar" data-dashboard-view="analytics">
      <%= render "analytics_dashboard", app: app %>
    </div>
    
    <!-- API Panel -->
    <div class="h-full hidden" data-dashboard-view="api">
      <%= render "api_explorer", app: app %>
    </div>
    
    <!-- Settings Panel -->
    <div class="h-full hidden overflow-y-auto p-4 sm:p-6 custom-scrollbar" data-dashboard-view="settings">
      <%= render "settings_content", app: app %>
    </div>
  </div>
</div>