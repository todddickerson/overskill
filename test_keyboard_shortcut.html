<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keyboard Shortcut Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-area {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
            min-height: 100px;
        }
        .log {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        .info {
            background: #e3f2fd;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        kbd {
            background: #fff;
            border: 1px solid #ccc;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>Keyboard Shortcut Test</h1>
    
    <div class="info">
        <strong>Platform:</strong> <span id="platform"></span><br>
        <strong>User Agent:</strong> <span id="userAgent"></span><br>
        <strong>Expected Shortcut:</strong> <span id="expectedShortcut"></span>
    </div>
    
    <div class="test-area">
        <h3>Test Area</h3>
        <p>Type in the textarea below and press <kbd id="shortcut">Cmd+Enter</kbd> (Mac) or <kbd>Ctrl+Enter</kbd> (Windows/Linux)</p>
        <textarea id="testTextarea" placeholder="Type here and press Cmd+Enter..."></textarea>
    </div>
    
    <div class="test-area">
        <h3>Event Log</h3>
        <div id="log" class="log">Waiting for keyboard events...</div>
    </div>
    
    <script>
        // Detect platform
        const platform = navigator.platform;
        const userAgent = navigator.userAgent;
        const isMac = platform.toUpperCase().indexOf('MAC') >= 0;
        
        // Display platform info
        document.getElementById('platform').textContent = platform;
        document.getElementById('userAgent').textContent = userAgent.substring(0, 50) + '...';
        document.getElementById('expectedShortcut').textContent = isMac ? 'Cmd+Enter' : 'Ctrl+Enter';
        document.getElementById('shortcut').textContent = isMac ? 'Cmd+Enter' : 'Ctrl+Enter';
        
        // Log function
        const logDiv = document.getElementById('log');
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.textContent = `[${timestamp}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        // Test textarea
        const textarea = document.getElementById('testTextarea');
        
        // Listen for all keyboard events
        textarea.addEventListener('keydown', (event) => {
            // Log all key events for debugging
            const modifiers = [];
            if (event.metaKey) modifiers.push('Meta');
            if (event.ctrlKey) modifiers.push('Ctrl');
            if (event.altKey) modifiers.push('Alt');
            if (event.shiftKey) modifiers.push('Shift');
            
            const modifierString = modifiers.length > 0 ? modifiers.join('+') + '+' : '';
            log(`Keydown: ${modifierString}${event.key} (keyCode: ${event.keyCode})`);
            
            // Check for the shortcut
            const expectedModifier = isMac ? event.metaKey : event.ctrlKey;
            
            if (expectedModifier && event.key === 'Enter') {
                event.preventDefault();
                log('✅ SHORTCUT DETECTED! Would submit form now.');
                
                // Visual feedback
                textarea.style.border = '2px solid #4CAF50';
                setTimeout(() => {
                    textarea.style.border = '1px solid #ccc';
                }, 500);
                
                // Show what would be submitted
                if (textarea.value.trim()) {
                    log(`Would submit: "${textarea.value}"`);
                } else {
                    log('⚠️ No content to submit');
                }
            }
        });
        
        // Also log keyup for completeness
        textarea.addEventListener('keyup', (event) => {
            if (event.metaKey || event.ctrlKey) {
                log(`Keyup: ${event.key}`);
            }
        });
        
        // Initial log
        log('Test ready. Start typing in the textarea.');
        log(`Platform detected as: ${isMac ? 'Mac' : 'Non-Mac'}`);
        log(`Expected modifier key: ${isMac ? 'Meta (Cmd)' : 'Ctrl'}`);
    </script>
</body>
</html>